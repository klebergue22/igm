<ui:composition template="/templates/template.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

  <ui:define name="title">Evaluación Médica Ocupacional</ui:define>

  <ui:define name="content">
    <h:outputStylesheet library="primefaces" name="primeicons/primeicons.css"/>

    <h:form id="form" enctype="multipart/form-data" styleClass="ui-fluid">

      <!-- Wizard sin barra nativa; usamos barra propia para asegurar back/next -->
      <p:wizard widgetVar="wiz" showNavBar="false" showStepStatus="true"
                nextLabel="Siguiente" backLabel="Anterior">

        <!-- ===================================================== -->
        <!-- STEP 1: FORMULARIO DE EVALUACIÓN MÉDICA (A–F)         -->
        <!-- ===================================================== -->
        <p:tab id="step1" title="Formulario (A–F)">

          <!-- A. Datos del establecimiento / usuario -->
          <p:panel header="A. Datos del establecimiento / usuario">
            <h:panelGrid columns="4" columnClasses="w-15rem, w-35rem, w-15rem, w-35rem" styleClass="ui-fluid">

              <h:outputLabel value="Institución del Sistema"/><p:inputText placeholder="Institución"/>
              <h:outputLabel value="RUC"/><p:inputText maxlength="13" placeholder="RUC"/>
              <h:outputLabel value="CIIU"/><p:inputText maxlength="10" placeholder="CIIU"/>
              <h:outputLabel value="Centro de trabajo"/><p:inputText placeholder="Centro de trabajo"/>
              <h:outputLabel value="N° Historia clínica"/><p:inputText placeholder="Historia clínica"/>
              <h:outputLabel value="N° Archivo"/><p:inputText placeholder="Archivo"/>

              <h:outputLabel value="Primer apellido"/><p:inputText placeholder="Primer apellido"/>
              <h:outputLabel value="Segundo apellido"/><p:inputText placeholder="Segundo apellido"/>
              <h:outputLabel value="Primer nombre"/><p:inputText placeholder="Primer nombre"/>
              <h:outputLabel value="Segundo nombre"/><p:inputText placeholder="Segundo nombre"/>
              <!-- ATENCIÓN PRIORITARIA -->
<p:panel header="ATENCIÓN PRIORITARIA" styleClass="mb-2">
  <div class="p-formgrid p-grid">
    <div class="p-field-checkbox p-col-12 p-md-2">
      <p:selectBooleanCheckbox id="ap_emb"/>
      <h:outputLabel for="ap_emb" value="Embarazada"/>
    </div>
    <div class="p-field-checkbox p-col-12 p-md-2">
      <p:selectBooleanCheckbox id="ap_disc"/>
      <h:outputLabel for="ap_disc" value="Persona con Discapacidad"/>
    </div>
    <div class="p-field-checkbox p-col-12 p-md-2">
      <p:selectBooleanCheckbox id="ap_cat"/>
      <h:outputLabel for="ap_cat" value="E. Catastrófica"/>
    </div>
    <div class="p-field-checkbox p-col-12 p-md-2">
      <p:selectBooleanCheckbox id="ap_lac"/>
      <h:outputLabel for="ap_lac" value="Lactancia"/>
    </div>
    <div class="p-field-checkbox p-col-12 p-md-2">
      <p:selectBooleanCheckbox id="ap_am"/>
      <h:outputLabel for="ap_am" value="Adulto Mayor"/>
    </div>
  </div>
</p:panel>


              <h:outputLabel value="Sexo"/>
              <p:selectOneRadio>
                <f:selectItem itemLabel="Hombre" itemValue="M"/>
                <f:selectItem itemLabel="Mujer"  itemValue="F"/>
              </p:selectOneRadio>

              <h:outputLabel value="Fecha de nacimiento"/><p:calendar pattern="dd/MM/yyyy" navigator="true"/>
              <h:outputLabel value="Grupo sanguíneo"/>
              <p:selectOneMenu>
                <f:selectItem itemLabel="--" itemValue=""/>
                <f:selectItem itemLabel="O+" itemValue="O+"/>
                <f:selectItem itemLabel="O-" itemValue="O-"/>
                <f:selectItem itemLabel="A+" itemValue="A+"/>
                <f:selectItem itemLabel="A-" itemValue="A-"/>
                <f:selectItem itemLabel="B+" itemValue="B+"/>
                <f:selectItem itemLabel="B-" itemValue="B-"/>
                <f:selectItem itemLabel="AB+" itemValue="AB+"/>
                <f:selectItem itemLabel="AB-" itemValue="AB-"/>
              </p:selectOneMenu>

              <h:outputLabel value="Lateralidad"/>
              <p:selectOneMenu>
                <f:selectItem itemLabel="--" itemValue=""/>
                <f:selectItem itemLabel="Diestro" itemValue="DIESTRO"/>
                <f:selectItem itemLabel="Zurdo" itemValue="ZURDO"/>
                <f:selectItem itemLabel="Ambidiestro" itemValue="AMBIDIESTRO"/>
              </p:selectOneMenu>

            </h:panelGrid>
          </p:panel>

          <p:separator/>

          <!-- B. Motivo de consulta -->
          <p:panel header="B. Motivo de consulta">
            <h:panelGrid columns="4" columnClasses="w-15rem, w-35rem, w-15rem, w-35rem" styleClass="ui-fluid">
              <h:outputLabel value="Puesto de trabajo (CIUO)"/><p:inputText placeholder="CIUO"/>
              <h:outputLabel value="Fecha de atención"/><p:calendar pattern="dd/MM/yyyy" navigator="true"/>
              <h:outputLabel value="Fecha de ingreso"/><p:calendar pattern="dd/MM/yyyy"/>
              <h:outputLabel value="Fecha de reintegro"/><p:calendar pattern="dd/MM/yyyy"/>
              <h:outputLabel value="Último día laboral"/><p:calendar pattern="dd/MM/yyyy"/>

              <h:outputLabel value="Evaluación"/>
              <p:selectOneRadio>
                <f:selectItem itemLabel="Ingreso" itemValue="INGRESO"/>
                <f:selectItem itemLabel="Periódico" itemValue="PERIODICO"/>
                <f:selectItem itemLabel="Reintegro" itemValue="REINTEGRO"/>
                <f:selectItem itemLabel="Retiro" itemValue="RETIRO"/>
              </p:selectOneRadio>

              <h:outputLabel value="Observación"/><p:inputTextarea rows="3" autoResize="true" placeholder="Observación"/>
            </h:panelGrid>
          </p:panel>

          <p:separator/>

          <!-- C. Antecedentes personales -->
          <p:panel header="C. Antecedentes personales">
            <h:panelGrid columns="2" columnClasses="w-20rem," styleClass="ui-fluid">
              <h:outputLabel value="Clínicos y quirúrgicos"/><p:inputTextarea rows="3" autoResize="true"/>
              <h:outputLabel value="Familiares"/><p:inputTextarea rows="3" autoResize="true"/>
              <h:outputLabel value="Condición especial (urgencias/tx)"/><p:inputTextarea rows="2" autoResize="true"/>
              <h:outputLabel value="Autoriza transfusiones"/>
              <p:selectOneRadio>
                <f:selectItem itemLabel="Sí" itemValue="S"/>
                <f:selectItem itemLabel="No" itemValue="N"/>
              </p:selectOneRadio>

              <h:outputLabel value="Tratamiento hormonal"/>
              <p:selectOneRadio>
                <f:selectItem itemLabel="Sí" itemValue="S"/>
                <f:selectItem itemLabel="No" itemValue="N"/>
              </p:selectOneRadio>
              <h:outputLabel value="¿Cuál?"/><p:inputText/>

              <p:separator/>

              <h:outputLabel value="FUM"/><p:calendar pattern="dd/MM/yyyy"/>
              <h:outputLabel value="Gestas"/><p:inputNumber decimalPlaces="0"/>
              <h:outputLabel value="Partos"/><p:inputNumber decimalPlaces="0"/>
              <h:outputLabel value="Cesáreas"/><p:inputNumber decimalPlaces="0"/>
              <h:outputLabel value="Abortos"/><p:inputNumber decimalPlaces="0"/>

              <h:outputLabel value="Planificación familiar"/>
              <p:selectOneMenu>
                <f:selectItem itemLabel="--" itemValue=""/>
                <f:selectItem itemLabel="Sí" itemValue="SI"/>
                <f:selectItem itemLabel="No" itemValue="NO"/>
                <f:selectItem itemLabel="No responde" itemValue="NR"/>
              </p:selectOneMenu>
              <h:outputLabel value="¿Cuál?"/><p:inputText/>

              <p:separator/>

              <h:outputLabel value="Exámenes repro. masculinos (¿cuál?)"/><p:inputText/>
              <h:outputLabel value="Tiempo (años)"/><p:inputNumber decimalPlaces="0"/>

              <p:separator/>

              <h:outputLabel value="Actividad física"/><p:inputText/>
              <h:outputLabel value="Condición preexistente"/><p:inputText/>
              <h:outputLabel value="Medicación habitual"/><p:inputText/>
              <h:outputLabel value="Observación"/><p:inputTextarea rows="2" autoResize="true"/>
            </h:panelGrid>
          </p:panel>

          <p:separator/>

          <!-- D. Enfermedad o problema actual -->
          <p:panel header="D. Enfermedad o problema actual">
            <p:inputTextarea rows="5" style="width:100%" placeholder="Descripción del problema actual"/>
          </p:panel>

          <p:separator/>

          <!-- E. Constantes vitales y antropometría -->
          <p:panel header="E. Constantes vitales y antropometría">
            <h:panelGrid columns="8" styleClass="ui-fluid">
              <h:outputText value="Temp (°C)"/><p:inputNumber decimalPlaces="1"/>
              <h:outputText value="PA (mmHg)"/><p:inputText placeholder="120/80"/>
              <h:outputText value="FC"/><p:inputNumber decimalPlaces="0"/>
              <h:outputText value="FR"/><p:inputNumber decimalPlaces="0"/>
              <h:outputText value="Sat O₂ (%)"/><p:inputNumber decimalPlaces="0"/>
              <h:outputText value="Peso (kg)"/><p:inputNumber decimalPlaces="2"/>
              <h:outputText value="Talla (cm)"/><p:inputNumber decimalPlaces="1"/>
              <h:outputText value="IMC"/><p:inputNumber decimalPlaces="2" disabled="true"/>
              <h:outputText value="Perímetro abd (cm)"/><p:inputNumber decimalPlaces="1"/>
            </h:panelGrid>
          </p:panel>

          <p:separator/>

          <!-- F. Examen físico regional (simplificado) -->
          <p:panel header="F. Examen físico regional">
            <h:panelGrid columns="4" styleClass="ui-fluid">
              <h:outputText value="Piel - Cicatrices"/><p:selectBooleanCheckbox/><h:outputText value="Numeral"/><p:inputText/>
              <h:outputText value="Ojos - Párpados"/><p:selectBooleanCheckbox/><h:outputText value="Numeral"/><p:inputText/>
              <h:outputText value="Oído - CAE"/><p:selectBooleanCheckbox/><h:outputText value="Numeral"/><p:inputText/>
              <h:outputText value="Tórax - Pulmones"/><p:selectBooleanCheckbox/><h:outputText value="Numeral"/><p:inputText/>
              <h:outputText value="Abdomen - Vísceras"/><p:selectBooleanCheckbox/><h:outputText value="Numeral"/><p:inputText/>
              <h:outputText value="Extremidades - Vascular"/><p:selectBooleanCheckbox/><h:outputText value="Numeral"/><p:inputText/>
              <h:outputText value="Neurológico - Reflejos"/><p:selectBooleanCheckbox/><h:outputText value="Numeral"/><p:inputText/>
              <h:outputText value="Observación global"/><p:inputTextarea rows="2" autoResize="true" colspan="3"/>
            </h:panelGrid>
          </p:panel>
        </p:tab>

        <!-- ===================================================== -->
        <!-- STEP 2: G. FACTORES DE RIESGO DEL TRABAJO ACTUAL       -->
        <!-- ===================================================== -->
        <p:tab id="step2" title="Riesgos (G)">
           <style>
            .risk-table { width:100%; border-collapse:collapse; font-size:13px; }
            .risk-table th, .risk-table td { border:1px solid #ccc; padding:6px 4px; vertical-align:middle; }
            .risk-header { background:#eaeaea; font-weight:600; text-align:center; }
            .risk-label { width: 26rem; white-space:normal; }
            .risk-cols { width: calc((100% - 26rem)/7); text-align:center; }
            .cell-input { width: 100%; }
            .cell-textarea { width:100%; resize:vertical; }
        </style>

        <p:panel header="Matriz de Identificación de Riesgos Laborales" toggleable="true" toggleSpeed="150">
            <h:panelGroup layout="block" styleClass="ui-fluid">

                <!-- Parámetro con columnas 1..7 -->
                <ui:param name="cols" value="#{['1','2','3','4','5','6','7']}" />

                <!-- Encabezados -->
                <table class="risk-table">
                    <thead>
                        <tr>
                            <th colspan="8" style="text-align:left; background:#f5f5f5;">
                                <h:outputText value="PUESTO DE TRABAJO"/>
                                <h:inputText id="puestoTrabajo" style="width:60%; margin-left:10px"
                                             placeholder="Ingrese nombre del puesto"/>
                            </th>
                        </tr>
                        <tr class="risk-header">
                            <th>ACTIVIDADES IMPORTANTES DENTRO DE LA JORNADA LABORAL</th>
                            <th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Fila: ACTIVIDAD LABORAL (input en cada columna) -->
                        <tr>
                            <td class="risk-label"><strong>ACTIVIDAD LABORAL</strong></td>
                            <ui:repeat value="#{cols}" var="c">
                                <td class="risk-cols">
                                    <p:inputText id="actLab_#{c}" styleClass="cell-input"
                                                 placeholder="Actividad #{c}"/>
                                </td>
                            </ui:repeat>
                        </tr>
                    </tbody>
                </table>

                <!-- ============================== -->
                <!-- BLOQUE FÍSICO -->
                <!-- ============================== -->
                <p:fieldset legend="FÍSICO" toggleable="true" collapsed="false" style="margin-top:10px;">
                    <table class="risk-table">
                        <tbody>
                            <tr>
                                <td class="risk-label">Temperaturas altas</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="fis_tempAltas_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Temperaturas bajas</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="fis_tempBajas_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Radiación ionizante</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="fis_radIon_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Radiación no ionizante</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="fis_radNoIon_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Ruido</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="fis_ruido_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Vibración</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="fis_vibracion_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Iluminación</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="fis_iluminacion_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Ventilación</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="fis_ventilacion_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Fluido eléctrico</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="fis_fluido_#{c}"/></td></ui:repeat>
                            </tr>
                            <!-- OTROS: inputs por columna -->
                            <tr>
                                <td class="risk-label"><em>Otros (Físico)</em></td>
                                <ui:repeat value="#{cols}" var="c">
                                    <td class="risk-cols">
                                        <p:inputText id="fis_otros_#{c}" styleClass="cell-input"
                                                     placeholder="Otro #{c}"/>
                                    </td>
                                </ui:repeat>
                            </tr>
                        </tbody>
                    </table>
                </p:fieldset>

                <!-- ============================== -->
                <!-- BLOQUE SEGURIDAD -->
                <!-- ============================== -->
                <p:fieldset legend="DE SEGURIDAD" toggleable="true" collapsed="true" style="margin-top:10px;">
                    <table class="risk-table">
                        <tbody>
                            <tr>
                                <td class="risk-label"><strong>LOCATIVOS</strong> — Falta de señalización, aseo, desorden</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="seg_locat_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label"><strong>MECÁNICOS</strong> — Atrapamiento entre máquinas y/o superficies</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="seg_mec_atrapMaquina_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Atrapamiento entre objetos</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="seg_mec_atrapObjetos_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Caída de objetos</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="seg_mec_caidaObjetos_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Caídas al mismo nivel</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="seg_mec_mismoNivel_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Caídas a diferente nivel</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="seg_mec_difNivel_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Pinchazos</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="seg_mec_pinchazos_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Cortes</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="seg_mec_cortes_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Choques / colisión vehicular</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="seg_mec_colision_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Atropellamientos por vehículos</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="seg_mec_atropello_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Proyección de fluidos</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="seg_mec_proyFluidos_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Proyección de partículas – fragmentos</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="seg_mec_proyPart_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label">Contacto con superficies de trabajo</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="seg_mec_superficies_#{c}"/></td></ui:repeat>
                            </tr>
                            <tr>
                                <td class="risk-label"><strong>ELÉCTRICOS</strong> — Contacto eléctrico</td>
                                <ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="seg_elec_contacto_#{c}"/></td></ui:repeat>
                            </tr>
                            <!-- OTROS: inputs por columna -->
                            <tr>
                                <td class="risk-label"><em>Otros (Seguridad)</em></td>
                                <ui:repeat value="#{cols}" var="c">
                                    <td class="risk-cols">
                                        <p:inputText id="seg_otros_#{c}" styleClass="cell-input" placeholder="Otro #{c}"/>
                                    </td>
                                </ui:repeat>
                            </tr>
                        </tbody>
                    </table>
                </p:fieldset>

                <!-- ============================== -->
                <!-- BLOQUE QUÍMICO -->
                <!-- ============================== -->
                <p:fieldset legend="QUÍMICO" toggleable="true" collapsed="true" style="margin-top:10px;">
                    <table class="risk-table">
                        <tbody>
                            <tr><td class="risk-label">Polvos</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="qui_polv_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Sólidos</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="qui_solidos_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Humos</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="qui_humos_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Líquidos</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="qui_liquidos_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Vapores</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="qui_vapores_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Aerosoles</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="qui_aerosoles_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Neblinas</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="qui_neblinas_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Gaseosos</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="qui_gases_#{c}"/></td></ui:repeat></tr>
                            <!-- OTROS: inputs por columna -->
                            <tr>
                                <td class="risk-label"><em>Otros (Químico)</em></td>
                                <ui:repeat value="#{cols}" var="c">
                                    <td class="risk-cols"><p:inputText id="qui_otros_#{c}" styleClass="cell-input" placeholder="Otro #{c}"/></td>
                                </ui:repeat>
                            </tr>
                        </tbody>
                    </table>
                </p:fieldset>

                <!-- ============================== -->
                <!-- BLOQUE BIOLÓGICO -->
                <!-- ============================== -->
                <p:fieldset legend="BIOLÓGICO" toggleable="true" collapsed="true" style="margin-top:10px;">
                    <table class="risk-table">
                        <tbody>
                            <tr><td class="risk-label">Virus</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="bio_virus_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Hongos</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="bio_hongos_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Bacterias</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="bio_bacterias_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Parásitos</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="bio_parasitos_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Exposición a vectores</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="bio_vectores_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Exposición a animales selváticos</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="bio_selvaticos_#{c}"/></td></ui:repeat></tr>
                            <!-- OTROS: inputs por columna -->
                            <tr>
                                <td class="risk-label"><em>Otros (Biológico)</em></td>
                                <ui:repeat value="#{cols}" var="c">
                                    <td class="risk-cols"><p:inputText id="bio_otros_#{c}" styleClass="cell-input" placeholder="Otro #{c}"/></td>
                                </ui:repeat>
                            </tr>
                        </tbody>
                    </table>
                </p:fieldset>

                <!-- ============================== -->
                <!-- BLOQUE ERGONÓMICO -->
                <!-- ============================== -->
                <p:fieldset legend="ERGONÓMICO" toggleable="true" collapsed="true" style="margin-top:10px;">
                    <table class="risk-table">
                        <tbody>
                            <tr><td class="risk-label">Manejo manual de cargas</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="erg_cargas_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Movimientos repetitivos</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="erg_repetitivos_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Posturas forzadas</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="erg_posturas_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Trabajos con PVD</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="erg_pvd_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Diseño inadecuado del puesto</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="erg_puesto_#{c}"/></td></ui:repeat></tr>
                            <!-- OTROS: inputs por columna -->
                            <tr>
                                <td class="risk-label"><em>Otros (Ergonómico)</em></td>
                                <ui:repeat value="#{cols}" var="c">
                                    <td class="risk-cols"><p:inputText id="erg_otros_#{c}" styleClass="cell-input" placeholder="Otro #{c}"/></td>
                                </ui:repeat>
                            </tr>
                        </tbody>
                    </table>
                </p:fieldset>

                <!-- ============================== -->
                <!-- BLOQUE PSICOSOCIAL -->
                <!-- ============================== -->
                <p:fieldset legend="PSICOSOCIAL" toggleable="true" collapsed="true" style="margin-top:10px;">
                    <table class="risk-table">
                        <tbody>
                            <tr><td class="risk-label">Monotonía del trabajo</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="psi_monotonia_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Sobrecarga laboral</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="psi_sobrecarga_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Alta responsabilidad</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="psi_responsabilidad_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Autonomía en decisiones</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="psi_autonomia_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Relaciones interpersonales</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="psi_relaciones_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Inestabilidad laboral</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="psi_inestabilidad_#{c}"/></td></ui:repeat></tr>
                            <tr><td class="risk-label">Amenaza delincuencial</td><ui:repeat value="#{cols}" var="c"><td class="risk-cols"><p:selectBooleanCheckbox id="psi_amenaza_#{c}"/></td></ui:repeat></tr>
                            <!-- OTROS: inputs por columna -->
                            <tr>
                                <td class="risk-label"><em>Otros (Psicosocial)</em></td>
                                <ui:repeat value="#{cols}" var="c">
                                    <td class="risk-cols"><p:inputText id="psi_otros_#{c}" styleClass="cell-input" placeholder="Otro #{c}"/></td>
                                </ui:repeat>
                            </tr>
                        </tbody>
                    </table>
                </p:fieldset>

                <!-- ============================== -->
                <!-- MEDIDAS PREVENTIVAS: inputs por columna -->
                <!-- ============================== -->
                <table class="risk-table" style="margin-top:10px;">
                    <tbody>
                        <tr>
                            <td class="risk-label"><strong>MEDIDAS PREVENTIVAS</strong></td>
                            <ui:repeat value="#{cols}" var="c">
                                <td class="risk-cols">
                                    <!-- Usa inputText para mantener altura compacta; cambia a inputTextarea si necesitas más texto -->
                                    <p:inputText id="medPrev_#{c}" styleClass="cell-input"
                                                 placeholder="Medida #{c}"/>
                                </td>
                            </ui:repeat>
                        </tr>
                    </tbody>
                </table>

            </h:panelGroup>
        </p:panel>

        </p:tab>

        <!-- ===================================================== -->
        <!-- STEP 3: H–O (Historia, resultados, aptitud, etc.)      -->
        <!-- ===================================================== -->
        <p:tab id="step3" title="Historia / Resultados (H–O)">
          <p:panel header="H. Actividad laboral / Incidentes / Accidentes / EO">
            <p:inputTextarea rows="3" style="width:100%"/>
          </p:panel>

          <p:separator/>

          <p:panel header="I. Actividades extralaborales">
            <p:inputTextarea rows="3" style="width:100%"/>
          </p:panel>

          <p:separator/>

          <p:panel header="J. Resultados de exámenes (imagen / laboratorio / otros)">
            <p:inputTextarea rows="3" style="width:100%" placeholder="Listado / resumen"/>
          </p:panel>

          <p:separator/>

          <p:panel header="K. Diagnóstico (PRE / DEF)">
            <h:panelGrid columns="4" styleClass="ui-fluid">
              <h:outputText value="Diagnóstico presuntivo"/><p:inputText/>
              <h:outputText value="Diagnóstico definitivo"/><p:inputText/>
              <h:outputText value="CIE-10 (opcional)"/><p:inputText/>
            </h:panelGrid>
          </p:panel>

          <p:separator/>

          <p:panel header="L. Aptitud médica para el trabajo">
            <p:selectOneRadio>
              <f:selectItem itemLabel="APTO" itemValue="APTO"/>
              <f:selectItem itemLabel="APTO EN OBSERVACIÓN" itemValue="APTO_OBS"/>
              <f:selectItem itemLabel="APTO CON LIMITACIONES" itemValue="APTO_LIMIT"/>
              <f:selectItem itemLabel="NO APTO" itemValue="NO_APTO"/>
            </p:selectOneRadio>
          </p:panel>

          <p:separator/>

          <p:panel header="M. Recomendaciones y/o tratamiento">
            <p:inputTextarea rows="3" style="width:100%"/>
          </p:panel>

          <p:separator/>

          <p:panel header="N. Retiro (evaluación)">
            <p:inputTextarea rows="2" style="width:100%" placeholder="Detalle de retiro (si aplica)"/>
          </p:panel>

          <p:separator/>

          <p:panel header="O. Datos del profesional">
            <h:panelGrid columns="4" styleClass="ui-fluid">
              <h:outputText value="Nombre y apellido"/><p:inputText/>
              <h:outputText value="Código médico"/><p:inputText/>
            </h:panelGrid>
          </p:panel>
        </p:tab>

        <!-- ===================================================== -->
        <!-- STEP 4: Visor PDF – Certificado                       -->
        <!-- ===================================================== -->
        <p:tab id="step4" title="Certificado (PDF)">
          <p:panel header="Certificado - Evaluación Médica Ocupacional">
            <!-- Ajusta la ruta a un PDF real en tu app, por ejemplo resources/pdf/ejemplo.pdf -->
            <object id="pdf_certificado" type="application/pdf"
                    data="/resources/pdf/ejemplo.pdf?pfdrid_c=true"
                    width="100%" height="600px">
              Su navegador no soporta PDF.
              <p:commandButton value="Descargar" ajax="false" icon="pi pi-download"/>
            </object>
          </p:panel>
        </p:tab>

      </p:wizard>

      <!-- Barra de navegación propia: SIEMPRE funciona -->
      <p:toolbar styleClass="mt-3">
        <p:toolbarGroup>
          <p:commandButton value="Anterior"
                           type="button"
                           icon="pi pi-angle-left"
                           onclick="PF('wiz').back();"
                           process="@this"
                           update=":form"/>
          <p:spacer width="8"/>
          <p:commandButton value="Siguiente"
                           type="button"
                           icon="pi pi-angle-right"
                           onclick="PF('wiz').next();"
                           process=":form"
                           update=":form"/>
        </p:toolbarGroup>
      </p:toolbar>

    </h:form>
  </ui:define>
</ui:composition>
